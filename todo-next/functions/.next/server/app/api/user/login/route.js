"use strict";(()=>{var e={};e.id=362,e.ids=[362],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},5194:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>v,patchFetch:()=>j,requestAsyncStorage:()=>f,routeModule:()=>y,serverHooks:()=>q,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{GET:()=>x,POST:()=>g});var r=t(9303),o=t(8716),a=t(670),i=t(7705),u=t(4164),p=t(7070),c=t(2023),d=t.n(c),l=t(1482),m=t.n(l);async function g(e){try{let{email:s,password:t}=await e.json(),n=await u.Z.findOne({email:s});if(!n)return p.NextResponse.json({message:"User not present"},{status:400});if(!await d().compare(t,n.password))return p.NextResponse.json({message:"Invalid Createntails"},{status:400});let r=m().sign({id:n._id,email:n.email,password:n.password},process.env.TOKEN_SECRET),o=p.NextResponse.json({message:"User Logined Successfully",id:n._id,token:r,sucess:!0},{status:200});return console.log(r),o.cookies.set("token",r,{httpOnly:!0}),o}catch(e){if(e instanceof Error)return p.NextResponse.json({message:e.message},{status:500});return p.NextResponse.json({message:"Something unknown happend"},{status:500})}}async function x(e){try{let e=await u.Z.find();return p.NextResponse.json(e)}catch(e){if(e instanceof Error)return p.NextResponse.json({message:e.message},{status:500});return p.NextResponse.json({message:"Something unknown happened"},{status:500})}}(0,i.Z)();let y=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/user/login/route",pathname:"/api/user/login",filename:"route",bundlePath:"app/api/user/login/route"},resolvedPagePath:"/Users/nayankumar/Desktop/Nextjs-Learning/todo-next/src/app/api/user/login/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:q}=y,v="/api/user/login/route";function j(){return(0,a.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:h})}},7705:(e,s,t)=>{t.d(s,{Z:()=>o});var n=t(1185),r=t.n(n);let o=async function(){try{r().connect(process.env.MONGO_URI);let e=r().connection;e.on("error",e=>{console.log(e.message),process.exit()}),e.on("connected",()=>{console.log("MongoDb connected successfully!..")})}catch(e){console.log("Something happened in ",e.message)}}},4164:(e,s,t)=>{t.d(s,{Z:()=>a});var n=t(1185),r=t.n(n);let o=new(r()).Schema({username:{type:String,require:["username is required mandatory",!0],unique:!0},email:{type:String,require:["email is required mandatory",!0],unique:!0},password:{type:String},createdAt:{type:Date}},{versionKey:!1}),a=r().models.user||r().model("user",o)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),n=s.X(0,[948,972,482,23],()=>t(5194));module.exports=n})();