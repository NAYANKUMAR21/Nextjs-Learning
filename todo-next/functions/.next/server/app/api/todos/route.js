"use strict";(()=>{var e={};e.id=603,e.ids=[603],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},6498:(e,o,t)=>{t.r(o),t.d(o,{originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{POST:()=>g});var r=t(9303),n=t(8716),a=t(670),i=t(7705),c=t(1482),u=t.n(c);async function p(e){try{let o=e.cookies.get("token")?.value||"";if(console.log(e.cookies.get("token"),o),!o)throw console.log(process.env.TOKEN_SECRET),Error("Token is empty string-> "+o);let t=u().verify(o,process.env.TOKEN_SECRET);return console.log(t),t.id}catch(e){if(e instanceof Error)throw console.log(e.message),Error(e.message);console.log("Something unknown happend in getToken file")}}var d=t(9509),l=t(7070);async function g(e){try{let o=await p(e);if(!o)return l.NextResponse.json({message:"Login first"},{status:500});let{todo:t}=await e.json(),s=await d.Z.create({userId:o,todo:t,isCompleted:!1,createdAt:Date.now()});return console.log(t,o),l.NextResponse.json({message:"Todo is added successfully",x:s})}catch(e){if(e instanceof Error)return l.NextResponse.json({message:e.message},{status:500});return l.NextResponse.json({message:"Something unknown happend"},{status:500})}}(0,i.Z)();let m=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/todos/route",pathname:"/api/todos",filename:"route",bundlePath:"app/api/todos/route"},resolvedPagePath:"/Users/nayankumar/Desktop/Nextjs-Learning/todo-next/src/app/api/todos/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:x}=m,y="/api/todos/route";function v(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},7705:(e,o,t)=>{t.d(o,{Z:()=>n});var s=t(1185),r=t.n(s);let n=async function(){try{r().connect(process.env.MONGO_URI);let e=r().connection;e.on("error",e=>{console.log(e.message),process.exit()}),e.on("connected",()=>{console.log("MongoDb connected successfully!..")})}catch(e){console.log("Something happened in ",e.message)}}},9509:(e,o,t)=>{t.d(o,{Z:()=>i});var s=t(1185),r=t.n(s);let n={todo:{type:String,require:!0},isCompleted:{type:Boolean,default:!1},createdAt:Date,userId:{type:r().Schema.Types.ObjectId,ref:"user",required:["Please enter User Id",!0]},update:{type:Boolean,default:!1}},a=new(r()).Schema(n,{versionKey:!1}),i=r().models.todo||r().model("todo",a)}};var o=require("../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),s=o.X(0,[948,972,482],()=>t(6498));module.exports=s})();